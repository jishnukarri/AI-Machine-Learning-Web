<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ocean Cleanup AI</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
</head>

<body>
  <div class="container">
    <h1>Ocean Cleanup AI</h1>
    <p>Classify images of ocean debris using AI-powered technology.</p>

    <!-- Slideshow Section -->
    <div class="slideshow">
      <div class="slideshow-image">
        <img id="current-image" src="" alt="Current Image">
      </div>
      <div class="slideshow-controls">
        <button id="prev-btn">❮ Previous</button>
        <button id="next-btn">Next ❯</button>
      </div>
      <div class="slideshow-result">
        <h2>Prediction</h2>
        <p><strong>Result:</strong> <span id="prediction-result">Waiting for input...</span></p>
      </div>
    </div>
  </div>

  <script>
    let model;
    let images = [
      'images/download (2).jpg',
      'images/download.jpg',
      'images/DSC02626-scaled.jpg',
      'images/gilthead-bream-Bristol-Aquarium6.jpg.jpg',
      'images/images (1).jpg',
      'images/images (3).jpg',
      'images/images (5).jpg',
      'images/OceanBotOne.jpeg',
      'images/OceanBotThree.jpg',
      'images/Screenshot 2025-04-04 131722.png',
      'images/sddefault.jpg',
      'images/shorebird-in-polluted-water.jpg',
      'images/Yellowfin-Horse-Mackerel.jpg'
    ];
    let currentIndex = 0;

    // Load the TensorFlow.js model
    async function loadModel() {
      try {
        model = await tf.loadLayersModel('model-new/model.json');
        console.log('Model loaded successfully!');
      } catch (error) {
        console.error('Error loading model:', error);
      }
    }

    // Display the current image
    function showImage(index) {
      if (index < 0 || index >= images.length) return;
      document.getElementById('current-image').src = images[index];
      document.getElementById('current-image').style.display = 'block';
      predict(images[index]);
    }

    // Predict the class of the selected image
    async function predict(imageSrc) {
      const img = new Image();
      img.src = imageSrc;
      img.onload = async () => {
        try {
          if (!model) {
            console.error('Model is not loaded yet.');
            return;
          }

          // Preprocess the image
          const tensor = tf.browser.fromPixels(img)
              .resizeNearestNeighbor([224, 224]) // Resize to match model input size
              .toFloat()
              .div(255.0) // Normalize pixel values
              .expandDims(); // Add batch dimension

          console.log('Tensor shape:', tensor.shape); // Should be [1, 224, 224, 3]

          // Make predictions
          const predictions = await model.predict(tensor).data();
          console.log('Predictions:', predictions);

          const result = predictions[0] > 0.5 ? 'Garbage' : 'Marine Life';
          document.getElementById('prediction-result').innerText = result;
        } catch (error) {
          console.error('Error during prediction:', error);
        }
      };
    }

    // Attach event listeners for navigation
    document.getElementById('prev-btn').addEventListener('click', () => {
      currentIndex = Math.max(currentIndex - 1, 0);
      showImage(currentIndex);
    });

    document.getElementById('next-btn').addEventListener('click', () => {
      currentIndex = Math.min(currentIndex + 1, images.length - 1);
      showImage(currentIndex);
    });

    // Load the model and display the first image when the page loads
    window.onload = async () => {
      await loadModel();
      showImage(currentIndex);
    };
  </script>
</body>

</html>